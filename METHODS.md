**Источники данных для расчета плотности населения:**

- Датасет buildings.geojson: https://drive.google.com/file/d/1ueVGpQ-3Kpjx38kF-JlEU6seTpezJp9C/view?usp=drive_link
- Реестр домов по Архангельской области: https://аис.фрт.рф/opendata?gid=2216073&cids=house_management&page=1&pageSize=12

Рассматриваемый населенный пункт **г. Архангельск.**  
Данные источников о количестве домов отличаются. Так в датасете список содержит **9600** строк, в реестре домов **4345** строк. На текущий момент для расчетов используется источник с реестром домов, т.к. содержит более полную информацию.  
_!!!В дальнейшем необходимо проработать вопрос о корректности данных источников._

**Исходные данные:** $Vliv$ = население г. Архангельск (2023 г.) = 298 617 чел. (источник https://ru.wikipedia.org/wiki/Архангельск)

**Описание алгоритма расчета:**  
1). Использовать данные о домах архангельской области - [https://аис.фрт.рф/opendata?gid=2216073&page=2&pageSize=12](https://xn--80aq1a.xn--p1aee.xn--p1ai/opendata?gid=2216073&page=2&pageSize=12)  
2). Сформировать выборку домов г.Архангельск с информацией о жилой площади каждого дома  
3). Рассчитать суммарную жилую площадь $Sliv$  
4). Рассчитать среднее количество площади на одного жителя г.Архангельск: $$Savg = Vliv/Sliv$$  
5). Рассчитать количество жителей на каждый дом, использую жилую площадь дома $Sn$ $$Vn = Sn / Savg$$  

**На выходе получаем:** слой с адресом дома и предполагаемым количеством проживающих в нем людей.


**Описание алгоритма расчета плотности населения с полигонами:**  

1). Сформировать сетку шестиугольников размером 500 м от центра до угла шестиугольника (пешая доступность в рамках 15 минут)   
2). Сгруппировать по координатам шестиугольники и координаты домов. Координаты домов есть в источнике данных Датасет, но отсутствуют в Реестре домов. В этом случае необходимо сопоставить два источника для обогащения данными или использовать только адреса домов.  
3). Сделать связку Дом-Шестиугольник, рассчитать для каждого шестиугольника количество проживающих людей и плотность населения на площадь шестиугольника.  

**На выходе получаем:** слой с полигонами и количеством населения проживающего в границах полигона.


**Методы расчетов параметров и характеристик.**  

**Расчет индекса "Обеспеченность парками".** (примерное описание парамтера, в дальнейшем треубется уточнение расчетов, корректирвока формулировок, форматирование)
_**Индекс обеспеченности**_ - числовое значение, отражающее уровень обеспеченности парками конкретного полигона базового слоя полигонов.

Для расчета индекса требуется получение данных:  
1). Выявить текущие места размещения парков, выгрузить их координаты с помощью 2 gis парсера https://github.com/interlark/parser-2gis/wiki https://2gis.ru/arkhangelsk/search/Парки%20и%20скверы%20?m=40.715501%2C64.540854%2F10.75
2). Выгрузить все городские объекты по "общественное питание" (кафе, рестораны, кофейни,шаурма), "Достопримечательности", "Гостиницы"  (гостиницы, хостелы), "Развлечения"  через 2 GIS. Выгрузить данные о цирках, театрах, больницах, школах, детских садах из уже существующих источников с Мин. культуры РФ, либо парсингом.

Данные должны быть представлены в виде Название объекта/Тип объекта/Гео-координаты/

**_Индекс обеспеченности полигона_** = сумма рейтингов парков, находящихся в данном полигоне.  
_**Рейтинг парка**_ определяется количеством населения, которое имеет доступ к парку из зоны покрытия парка, и городскими объектами расположенными в зоне покрытия парка.  
_**Зона покрытия парка**_ - полигон в форме шестиугольника, центром которого являются координаты центра парка, радиус описанной окружности = 0,5 диагонали полигона парка + 500 м.
_**Полигон парка**_ - прямоугольник с коорлинатами верхнего правого и левого нижнего угла, полностью вмещающий в себя парк. Если полигон парка отсутсвует, то в качестве зоны покрытия использовать полигон базовой сетки, в котором находятся координаты центра парка  и 50% населения полигонов, примыкающих к полигону с парком.

**Расчет рейтинга парка:**
**1). Для объектов типа "парк" каждый параметр объекта имеет свой вес от 0 до 1 (соответствует %%):**
Параметры и их веса (примерные параметры для Парков):

- "Охват населения в пешей доступности"  (~~100~~ 0.35)
- "Бизнес эффект" (~~50~~ 0.15)
- "Притяжение соц. инфраструктуры" (~~30~~ 0.1)
- "Транспортная доступность" (~~30~~ 0.1)
- "Достопримечательность" (~~70~~ 0.3 )

Задает вес параметров пользователь (аналитик, админ продукта) для каждой категории в отдельности.
_!На текущем этапе разработки веса используются как константы._

**2). Расчет самих параметров на примере парков **

**"Охват населения в пешей доступности"**

1). Сначала вычисляем медианную плотность населения среди всех полигонов города; 

2). Берем медианную плотность за эталонную, которую должен обеспечить парк в данном населенном пункте (например, медианная плотность 2700 чел);

3). Далее рассчитываем население население в зоне покрытия парка;

4). Делим охват на медианный полигон и получаем параметр охвата населения для октагона в котором расположен выбранный парк. Параметр охвата населения не может превышать 1

Например, 1000/2700=0,37

**"Бизнес эффект"**
1). Рассчитываем количество объектов для каждого полигона базового слоя.
2). Рассчитываем медианное количество объектов среди полигонов, в которых количество объектов > 0
3). Рассчитывается количество в зоне покрытия парка.
4). Делим количство объектов в зоне покрытия парка на медианное. Значение max = 1.
Пример,
Медианное: (10+6+20)/3)=12
В зоне покрытия: 10
Рассчет значения 10/12=0,83

**"Социальная инфраструктура""**
Считаем аналогично  бизнес эффекту только в расчет берутся из существующих источников:
"Театры", "Кинотеатры", "Музеи", "Библиотеки" , "Учреждения культурно-досугового типа", "Филармонии и концертные залы"

**"Транспортная доступность"**
Считаем аналогично бизнес эффекту только в расчет, парсим 2 GIS количество "автобусных остановок" и "парковок" вблизи парка
Расчет аналогично бизнес эффекту

**"Достопримечательность"**
Считаем аналогично только в расчет берутся из существующих источников:
Данные об объектах туризма.

........

**Далее считаем  сумму все параметров с учетом весов:**

- "Охват населения в пешей доступности"   0,37  * 0,35 = 0,37
+.
- "Бизнес эффект" 0,83 * 0,35 = 0,29
+.
- "Притяжение соц. инфраструктуры" 0,3 * 0,1 = 0,03
+.
- "Транспортная доступность" 0,5 * 0,1 = 0,05
+.
-  "Достопримечательность" 1 * 0,3 = 0,3 

=Рейтинг парка.  0,8

Эталонный парк - это все веса умноженные на 1: 1 + 0,35 + 0,1 + 0,1 + 0,3 = 1,85 (100+ 50+30+15+70=265)

В полигоне (шестиугольнике где располагается сам парк) коэффициент обеспеченности всегда равен 100% от полученного результата. В граничащих полигонах 50%.  Например 0,8  в полигоне, где есть парк и 0,4 в граничащих полигонах.

Далее значения сравниваются с рассчитанным эталоном.  Где коэффициент рассчитанного эталона это max коэффициента.  
На карте рейтинг визуализируется для каждого полигона, цель найти те полигоны, где рейтинг менее 25% от эталона и высока плотность населения и приоритизировать те полигоны где нужно в первую очередь разместит парк.  

